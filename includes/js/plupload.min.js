$(document).ready(function(){var baseurl=$('#baseurl').val();var i=0;$('.uploadFiles').click(function(){$('#uploadBox').dialog('open');return false})
$('#uploadBox').dialog({autoOpen:false,modal:true,buttons:{'Close':function(){$(this).dialog('close')}},width:1000,height:500})
function log(){var str="";plupload.each(arguments,function(arg){var row="";if(typeof(arg)!="string"){plupload.each(arg,function(value,key){if(arg instanceof plupload.File){switch(value){case plupload.QUEUED:value='QUEUED';break;case plupload.UPLOADING:value='UPLOADING';break;case plupload.FAILED:value='FAILED';break;case plupload.DONE:value='DONE';break;}}
if(typeof(value)!="function"){row+=(row?', ':'')+key+'='+value;}});str+=row+" ";}else{str+=arg+" ";}});$('#log').val($('#log').val()+str+"\r\n");}
$("#uploader").pluploadQueue({runtimes:'gears,browserplus,silverlight,flash,html4',url:baseurl+'index.php/vault/plupload/uploadtoserver',max_file_size:'2000mb',chunk_size:'1mb',unique_names:true,resize:{width:320,height:240,quality:90},filters:[{title:"Image files",extensions:"jpg,gif,png"},{title:"Zip files",extensions:"zip"},{title:"Media Files",extensions:'flv,mp4'}],flash_swf_url:baseurl+'js/plupload/plupload.flash.swf',silverlight_xap_url:baseurl+'js/plupload/plupload.silverlight.xap',preinit:{Init:function(up,info){log('[Init]','Info:',info,'Features:',up.features);},UploadFile:function(up,file){log('[UploadFile]',file);}},init:{Refresh:function(up){log('[Refresh]');},StateChanged:function(up){log('[StateChanged]',up.state==plupload.STARTED?"STARTED":"STOPPED");},QueueChanged:function(up){log('[QueueChanged]');},UploadProgress:function(up,file){log('[UploadProgress]','File:',file,"Total:",up.total);},FilesAdded:function(up,files){log('[FilesAdded]');plupload.each(files,function(file){log('  File:',file);});},FilesRemoved:function(up,files){log('[FilesRemoved]');plupload.each(files,function(file){log('  File:',file);});},FileUploaded:function(up,file,info){log('[FileUploaded] File:',file,"Info:",info);var files=$('<p><a target="_blank" href="'+baseurl+'/uploads/'+file.target_name+'">Files '+i+'</a>size : '+file.size+'</p>')
$(files).hide().insertAfter('#insertAfterme').slideDown('slow');i++},ChunkUploaded:function(up,file,info){log('[ChunkUploaded] File:',file,"Info:",info);},Error:function(up,args){if(args.file){log('[error]',args,"File:",args.file);}else{log('[error]',args);}}}});$('#log').val('');$('#clear').click(function(e){e.preventDefault();$("#uploader").pluploadQueue().splice();});})